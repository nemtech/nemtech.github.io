
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Writing a Schema &#8212; Symbol Documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:400,400i,700&display=swap" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/examplecode.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'Main',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/custom.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/examplecode.js"></script>
    <script type="text/javascript" src="https://unpkg.com/mermaid@7.1.0/dist/mermaid.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SDK Development" href="sdk-development.html" />
    <link rel="prev" title="Guidelines" href="../contribute/contributing.html" />
  
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=5'>
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-174021413-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-174021413-2');
</script>

  
  <link rel="alternate" type="application/atom+xml"  href="../guides/atom.xml" title="Blog">
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body>

<div class="navbar navbar-default gradient navbar-fixed-top"
     id="navbar">
    <div class="container navbar-top hidden-xs hidden-sm">
        <div class="row">
            <div class="col-lg-8 col-md-7">
                <div id="language">
    <label class="select">
        <select>
            <option id="english" value="en">EN</option>
            <option id="japanese" value="ja">JA</option>
            <!--<option id="chinese" value="zh_CN">中文</option>-->
            <option id="translate" value="translate">Translate</option>
        </select>
    </label>
</div>
            </div>
            <div class="col-lg-4 col-md-5">
                
                <div id="search-box">
    <input class="search search-desktop form-control" placeholder="Search"/>
</div>
                
                <ul id="social" class="list-inline">
    <li>
        <a href="https://twitter.com/NEMofficial" rel="nofollow"><i class="fab fa-twitter" title="Twitter"></i></a>
    </li>
    <li>
        <a href="https://discord.com/invite/xymcity" rel="nofollow" title="Discord"><i class="fab fa-discord"></i></a>
    </li>
    <li>
        <a href="https://github.com/symbol/" rel="nofollow" title="GitHub"><i class="fab fa-github"></i></a>
    </li>
</ul>
            </div>
        </div>
    </div>
    <hr/>
    <div class="container navbar-main">
        <div class="row">
            <div class="navbar-header col-lg-6 col-md-4 col-xs-6">
                <a class="navbar-brand" href="../index.html">
                    
                    <span><img alt="NEM logo" src="../_static/logo-symbol.svg"></span>
                    
                </a>
            </div>
            <div class="navbar-right col-lg-6 col-md-8 hidden-xs hidden-sm">
                <ul class="list-inline">
    <li>
        <a href="/getting-started/what-is-symbol.html" class="">Getting Started</a>
    </li>
    <li>
        <a href="/concepts/overview.html" class="">Features</a>
    </li>
    <li>
        <a href="/guides/category.html" class="">Guides</a>
    </li>
    <li>
        <a href="/references/overview.html" class="">Tools</a>
    </li>
    <li>
        <a href="/contribute/community.html" class="active">Help</a>
    </li>
</ul>
            </div>
            <div class="navbar-right col-xs-6 hidden-lg hidden-md">
                
                <div id="search-box">
    <input class="search search-mobile form-control" placeholder="Search"/>
</div>
                

            </div>
        </div>
        <div class="row">
            <div class="col-md-12 sidebar-xs visible-xs visible-sm">
                <div class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Navigation <b
                            class="caret"></b></a>
                    <ul class="dropdown-menu globaltoc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/overview.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/index.html">References</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../contribute/index.html">Contributing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../contribute/community.html">Community</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../contribute/contributing.html">Guidelines</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Writing a Schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="sdk-development.html">SDK Development</a></li>
<li class="toctree-l3"><a class="reference internal" href="sdk-documentation.html">SDK Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="generating-transaction-builders.html">Generating transaction builders</a></li>
<li class="toctree-l3"><a class="reference internal" href="style-guide.html">Style guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="suggesting-changes.html">Suggesting documentation changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="writing-a-guide.html">Writing a guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="translating-the-documentation.html">Translating the documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/glossary.html">Glossary</a></li>
</ul>
</li>
</ul>
</ul>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        
        

<div class="col-md-3">
    <div id="sidebar" class="bs-sidenav" role="complementary">
        
        <div class="sidebar-md hidden-xs hidden-sm">
    <h4>Navigation</h4>
    <hr />
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/overview.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/index.html">References</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../contribute/index.html">Contributing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../contribute/community.html">Community</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../contribute/contributing.html">Guidelines</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Writing a Schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="sdk-development.html">SDK Development</a></li>
<li class="toctree-l3"><a class="reference internal" href="sdk-documentation.html">SDK Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="generating-transaction-builders.html">Generating transaction builders</a></li>
<li class="toctree-l3"><a class="reference internal" href="style-guide.html">Style guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="suggesting-changes.html">Suggesting documentation changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="writing-a-guide.html">Writing a guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="translating-the-documentation.html">Translating the documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/glossary.html">Glossary</a></li>
</ul>
</li>
</ul>

</div>
        
    </div>
</div>


        
        <div class="col-md-7 content">
            
  <div class="section" id="writing-a-schema">
<h1>Writing a Schema<a class="headerlink" href="#writing-a-schema" title="Permalink to this headline">¶</a></h1>
<p>Are you writing a new catapult plugin that includes a new transaction type?</p>
<p>In this guide, we examine how the <a class="reference external" href="https://github.com/symbol/catbuffer-schemas/blob/main/schemas/transfer/transfer.cats">transfer.cats</a> was constructed.
You can adapt the same steps to define a new schema.</p>
<div class="section" id="instructions">
<h2>Instructions<a class="headerlink" href="#instructions" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Clone the catbuffer-schemas repository.</li>
</ol>
<div class="highlight-bash"><div class="highlight"><pre><span></span>git clone https://github.com/symbol/catbuffer-schemas.git
</pre></div>
</div>
<p>2. Create a new file under the <code class="docutils literal"><span class="pre">schemas</span></code> folder.
In our case, we have named the file <code class="docutils literal"><span class="pre">transfer.cats</span></code>.</p>
<ol class="arabic simple" start="3">
<li>Define the struct for the transaction body.</li>
</ol>
<p>Think of a struct as a set of properties that we want to store in the same block of memory.</p>
<p>The transaction body contains the extra properties which differ from a basic transaction.
Each attribute can have one of the types defined in <a class="reference external" href="https://github.com/symbol/catbuffer-schemas/blob/main/schemas/types.cats">types.cats</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># binary layout for a transfer transaction</span>
<span class="n">struct</span> <span class="n">TransferTransactionBody</span>
    <span class="c1"># transaction recipient</span>
    <span class="n">recipient</span> <span class="o">=</span> <span class="n">UnresolvedAddress</span>
    <span class="c1"># size of attached message</span>
    <span class="n">messageSize</span> <span class="o">=</span> <span class="n">uint16</span>
    <span class="c1"># number of attached mosaics</span>
    <span class="n">mosaicsCount</span> <span class="o">=</span> <span class="n">uint8</span>
    <span class="c1"># transaction message</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">byte</span><span class="p">,</span> <span class="n">messageSize</span><span class="p">)</span>
    <span class="c1"># attached mosaics</span>
    <span class="n">mosaics</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">UnresolvedMosaic</span><span class="p">,</span> <span class="n">mosaicsCount</span><span class="p">,</span> <span class="n">sort_key</span><span class="o">=</span><span class="n">mosaicId</span><span class="p">)</span>
</pre></div>
</div>
<p>4. Define a second transaction struct in the same file.
This will contain information about the version of the entity and its identifier.
The underlying transaction properties and the particular transaction body are appended as inlines.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># binary layout for a non-embedded transfer transaction</span>
<span class="n">struct</span> <span class="n">TransferTransaction</span>
    <span class="n">const</span> <span class="n">uint8</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">const</span> <span class="n">EntityType</span> <span class="n">entityType</span> <span class="o">=</span> <span class="mh">0x4154</span>

    <span class="n">inline</span> <span class="n">Transaction</span>
    <span class="n">inline</span> <span class="n">TransferTransactionBody</span>
</pre></div>
</div>
<p>5. Define an EmbeddedTransaction struct to serialize the inner transactions within an aggregate.
The embedded transaction and the body transaction are added as inlines.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># binary layout for an embedded transaction</span>
<span class="n">struct</span> <span class="n">EmbeddedTransaction</span>
    <span class="n">inline</span> <span class="n">SizePrefixedEntity</span>
    <span class="n">inline</span> <span class="n">EntityBody</span>
</pre></div>
</div>
<p>6. The catbuffer library allows you to generate the transaction builders from the schema we have defined.
For example, run the following command to generate C++ code:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>python main.py --schema schemas/transfer/transfer.cats --generator cpp_builder
</pre></div>
</div>
<p>The generator creates the transaction builders file under the <code class="docutils literal"><span class="pre">_generated/cpp_builder</span></code> folder.</p>
</div>
</div>

  <div class="section">
  
  
  </div>

            
            <p class="feedback">
                <hr/>
                Did you find what you were looking for?
                <a href="https://github.com/symbol/symbol-docs/issues/new/choose" target="_blank">Give us your feedback.</a>
            </p>
            
        </div>
         

<div class="col-md-2">
    <div class="bs-sidenav secondary" role="complementary">
    
    <div class="edit-github">
    <a href="https://github.com/symbol/symbol-docs/edit/main/source/guidelines/writing-a-schema.rst" rel="nofollow"> <i class="fab fa-github"></i> Improve this page</a>
</div>
    <span class="title">On this page</span>
    <ul>
<li><a class="reference internal" href="#">Writing a Schema</a><ul>
<li><a class="reference internal" href="#instructions">Instructions</a></li>
</ul>
</li>
</ul>

    
    </div>
</div>

 
    </div>
</div>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript">
    docsearch({
        apiKey: 'fea87a364e2d51e3729a3a4889f7fe61',
        indexName: 'nemtech',
        inputSelector: '.search-desktop',
        debug: false
    });

    docsearch({
        apiKey: 'fea87a364e2d51e3729a3a4889f7fe61',
        indexName: 'nemtech',
        inputSelector: '.search-mobile',
        debug: false
    });
</script>

  </body>
</html>